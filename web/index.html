<!DOCTYPE html>
<html>
    <head>
    <title>Hex pattern highlighter</title>
    <link rel="stylesheet" type="text/css" href="set.css">
    <script>
        function myFunction() {
            document.getElementById("err").innerHTML = "";
            var hex_re = /^[0-9A-Fa-f\n]+$/;
            var data = document.getElementById("message").value;
            var lines = data.split('\n');
            var err = false;
            for(var i = 0;i < lines.length;i++){
                if (lines[i].charAt(0) != '#') {
                    var t = hex_re.test(lines[i]);
                    if (!t) {
                        document.getElementById("err").innerHTML = "Error line :" + (i + 1) + " (not hex, not comment)";
                        err = true;
                        break;
                    }
                    if (lines[i].length % 2) {
                        document.getElementById("err").innerHTML = "Error line: " + (i + 1) + " (length not even)";
                        err = true;
                        break;
                    }
                }
            }
            if (err) {
                return ;
            }


            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                document.getElementById("results").innerHTML = this.responseText;
                }
            };
            xhttp.open("POST", "__POST_URL__", true);
            xhttp.send(document.getElementById("message").value)
        }

    </script>
    </head>
<body>
    <div align="center">
        <h1 style = "font-family:sans-serif">Hex Pattern Highlighter</h1>
    </div>
    This is a pattern highlighter for hexdecimal data. <br>
    It was originally designed to find common patterns between network packets.<br>
    Put hexadecimal data to compare on different lines. <br>
    Use # for comments.<br><br>
    Data minimum size and pattern lookup size: 4 bytes (8 hex digit).<br>
<br>

<textarea id="message" rows="15" cols="60">
# Example
00112233445566778899
aabbcc11223344cafedeca
cafedeca66778899</textarea>
<div> <button onclick="myFunction()">Go !</button> </div>


<br>
<br>
<div id="err"> </div>
<div id="results" class="results"> </div>

</body>
</html>
